# Test Environment Configuration
# Copy to .env.test.local for local overrides

# ============================================================================
# Database Configuration (Test)
# ============================================================================
TEST_DATABASE_URL=postgresql+asyncpg://circles_test:circles_test@localhost:5433/circles_test
TEST_DATABASE_POOL_SIZE=5
TEST_DATABASE_MAX_OVERFLOW=10

# ============================================================================
# Redis Configuration (Test)
# ============================================================================
TEST_REDIS_URL=redis://localhost:6380/0
TEST_USE_REAL_REDIS=false  # Use fakeredis by default (faster)

# ============================================================================
# Celery Configuration (Test)
# ============================================================================
CELERY_BROKER_URL=redis://localhost:6380/0
CELERY_RESULT_BACKEND=redis://localhost:6380/1
TEST_USE_REAL_CELERY=false  # Use eager mode (synchronous) by default

# ============================================================================
# LLM API Configuration (Test)
# ============================================================================
TEST_ANTHROPIC_API_KEY=sk-ant-test-mock-key-12345
TEST_OPENAI_API_KEY=sk-test-mock-key-67890
TEST_USE_REAL_APIS=false  # Use mocked APIs by default

# ============================================================================
# File Storage Configuration (Test)
# ============================================================================
TEST_UPLOAD_DIR=/tmp/circles_test_uploads
TEST_FIXTURES_DIR=tests/fixtures

# ============================================================================
# Test Behavior Configuration
# ============================================================================
TEST_USE_REAL_DB=true       # Use real PostgreSQL for better isolation
TEST_USE_TRANSACTION_ROLLBACK=true  # Rollback transactions after tests

# ============================================================================
# Test Timeout Configuration
# ============================================================================
TEST_TIMEOUT_SECONDS=30
TEST_ASYNC_TEST_TIMEOUT_SECONDS=60

# ============================================================================
# Coverage Threshold Configuration
# ============================================================================
TEST_COVERAGE_THRESHOLD_UNIT=90        # Unit tests should have 90% coverage
TEST_COVERAGE_THRESHOLD_INTEGRATION=80 # Integration tests 80%
TEST_COVERAGE_THRESHOLD_E2E=70         # E2E tests 70%
TEST_COVERAGE_THRESHOLD_TOTAL=85       # Total coverage 85%

# ============================================================================
# Test Parallelization
# ============================================================================
TEST_MAX_PARALLEL_WORKERS=4  # Use pytest-xdist for parallel execution

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_LEVEL=INFO
PYTEST_LOG_LEVEL=INFO

# ============================================================================
# Integration Test Specific
# ============================================================================
# For integration tests with real services:
# TEST_USE_REAL_REDIS=true
# TEST_USE_REAL_CELERY=true

# ============================================================================
# E2E Test Specific
# ============================================================================
# For E2E tests with full stack:
# TEST_USE_REAL_REDIS=true
# TEST_USE_REAL_CELERY=true
# (Keep TEST_USE_REAL_APIS=false to use mocks and avoid costs)

# ============================================================================
# Local Development Overrides
# ============================================================================
# Create .env.test.local for local overrides (not committed to git)
# Example:
# TEST_USE_REAL_APIS=true
# ANTHROPIC_API_KEY=sk-ant-your-real-key
# OPENAI_API_KEY=sk-your-real-key
